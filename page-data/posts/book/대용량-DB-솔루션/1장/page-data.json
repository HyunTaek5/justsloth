{"componentChunkName":"component---src-template-post-tsx","path":"/posts/book/대용량-DB-솔루션/1장","result":{"data":{"allMarkdownRemark":{"nodes":[{"fields":{"slug":"/posts/book/review/NGINX-쿡북/"},"timeToRead":1,"frontmatter":{"title":"NGINX 쿡북","series":"책 리뷰"}},{"fields":{"slug":"/posts/book/review/처음-시작하는-FastAPI/"},"timeToRead":1,"frontmatter":{"title":"처음 시작하는 FastAPI","series":"책 리뷰"}},{"fields":{"slug":"/posts/book/review/업무에-활용하는-nodejs/"},"timeToRead":1,"frontmatter":{"title":"업무에 활용하는 Node.js","series":"책 리뷰"}},{"fields":{"slug":"/posts/book/review/한권으로-배우는-도커&쿠버네티스/"},"timeToRead":1,"frontmatter":{"title":"한 권으로 배우는 도커 & 쿠버네티스","series":"책 리뷰"}},{"fields":{"slug":"/posts/book/review/도시를-만드는-기술-이야기/"},"timeToRead":1,"frontmatter":{"title":"도시를 만드는 기술 이야기","series":"책 리뷰"}},{"fields":{"slug":"/posts/book/가상-면접-사례-솔루션/1장/"},"timeToRead":1,"frontmatter":{"title":"사용자 수에 따른 규모 확장성","series":"가상 면접 사례로 배우는 대규모 시스템 설계 기초"}},{"fields":{"slug":"/posts/book/review/게임AI를-위한-탐색-알고리즘/"},"timeToRead":1,"frontmatter":{"title":"게임 AI를 위한 탐색 알고리즘","series":"책 리뷰"}},{"fields":{"slug":"/posts/블로그-이관/"},"timeToRead":1,"frontmatter":{"title":"블로그 이관","series":null}},{"fields":{"slug":"/posts/블로그-글-시작하기/"},"timeToRead":1,"frontmatter":{"title":"기술 블로그 글 시작하기","series":"글 잘 쓰기"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/프로젝트-회고/"},"timeToRead":1,"frontmatter":{"title":"2023 사내 프로젝트 회고","series":"배포 회고"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/나무늘보-프롬프트/"},"timeToRead":1,"frontmatter":{"title":"GPT-4 나무늘보 프롬프트","series":"프롬프트"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/채팅-리서치/"},"timeToRead":1,"frontmatter":{"title":"채팅 구현 관련 서비스 리서치","series":"리서치 기록"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/NestJs/Request-LifeCycle/"},"timeToRead":1,"frontmatter":{"title":"NestJs - Request LifeCycle","series":"NestJs"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/NestJs/LifeCycle/"},"timeToRead":1,"frontmatter":{"title":"NestJs - LifeCycle","series":"NestJs"}},{"fields":{"slug":"/posts/TIL/2023/2023-12/DirtyChecking/"},"timeToRead":1,"frontmatter":{"title":"더티 체킹","series":null}},{"fields":{"slug":"/posts/TIL/2023/2023-11/NestJs/Pipes/"},"timeToRead":1,"frontmatter":{"title":"NestJs - Pipes","series":"NestJs 개념 정리"}},{"fields":{"slug":"/posts/TIL/2023/2023-11/Nginx/"},"timeToRead":1,"frontmatter":{"title":"Docker-compose, Nginx와 함께하는 무중단 배포","series":"배포 회고"}},{"fields":{"slug":"/posts/TIL/2023/2023-11/NestJs/MetaData/"},"timeToRead":1,"frontmatter":{"title":"NestJs - MetaData","series":"NestJs 개념 정리"}},{"fields":{"slug":"/posts/TIL/2023/2023-11/AWS - EBS용량관리/"},"timeToRead":1,"frontmatter":{"title":"AWS - EBS 용량 관리","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-11/NestJs/DynamicModule/"},"timeToRead":1,"frontmatter":{"title":"NestJs - Dynamic Module","series":"NestJs 개념 정리"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/OpenTelemetry/메트릭/"},"timeToRead":1,"frontmatter":{"title":"OpenTelemetry  - 메트릭","series":"TIL"}},{"fields":{"slug":"/posts/사이드프로젝트-배포-회고/"},"timeToRead":2,"frontmatter":{"title":"사이드 프로젝트 배포 회고","series":"배포 회고"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/OpenTelemetry/시그널-분산추적/"},"timeToRead":1,"frontmatter":{"title":"OpenTelemetry 시그널 - 분산 추적","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/OpenTelemetry/컨텍스트-전파/"},"timeToRead":1,"frontmatter":{"title":"OpenTelemetry - 컨텍스트 전파","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/OpenTelemetry/파이프라인-리소스/"},"timeToRead":1,"frontmatter":{"title":"OpenTelemetry - 파이프라인, 리소스","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/OpenTelemetry/"},"timeToRead":1,"frontmatter":{"title":"OpenTelemetry","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/제3자-결제-애플/"},"timeToRead":3,"frontmatter":{"title":"관찰 가능성 엔지니어링 & 제 3자 결제 - 애플","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/제3자-결제-구글/"},"timeToRead":1,"frontmatter":{"title":"제 3자 결제 - 구글","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/PortOne-웹훅/"},"timeToRead":1,"frontmatter":{"title":"PortOne - 웹훅","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-10/PortOne-인증결제/"},"timeToRead":1,"frontmatter":{"title":"PortOne - 인증결제","series":"TIL"}},{"fields":{"slug":"/posts/book/대용량-DB-솔루션/1장/"},"timeToRead":1,"frontmatter":{"title":"대용량 DB 솔루션 1장 정리","series":"대용량 DB 솔루션"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/PortOne/"},"timeToRead":1,"frontmatter":{"title":"PortOne - 비인증결제 정리","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/인앱-결제/환불/"},"timeToRead":1,"frontmatter":{"title":"인앱 결제 환불 정리","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/인앱-결제/"},"timeToRead":1,"frontmatter":{"title":"인앱 결제 정리","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/SRE/"},"timeToRead":1,"frontmatter":{"title":"SRE (Site Reliability Engineering) 개념","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/SQL-INTERSECT/"},"timeToRead":1,"frontmatter":{"title":"SQL - INTERSECT","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/SQL-UNION-ALL/"},"timeToRead":1,"frontmatter":{"title":"SQL - UNION / UNION ALL","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/MongoDB-local-참가-후기/"},"timeToRead":1,"frontmatter":{"title":"MongoDB.local Seoul 짧은 참가 후기","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/OLTP VS OLAP/"},"timeToRead":1,"frontmatter":{"title":"OLTP vs OLAP","series":"TIL"}},{"fields":{"slug":"/posts/TIL/2023/2023-09/TypeORM-Upsert-중복제거/"},"timeToRead":1,"frontmatter":{"title":"TypeORM orIgnore 메소드 Upsert시 중복 데이터 INSERT 검증 방식 변경","series":"TIL"}}],"group":[{"fieldValue":"NestJs","totalCount":2},{"fieldValue":"NestJs 개념 정리","totalCount":3},{"fieldValue":"TIL","totalCount":19},{"fieldValue":"가상 면접 사례로 배우는 대규모 시스템 설계 기초","totalCount":1},{"fieldValue":"글 잘 쓰기","totalCount":1},{"fieldValue":"대용량 DB 솔루션","totalCount":1},{"fieldValue":"리서치 기록","totalCount":1},{"fieldValue":"배포 회고","totalCount":3},{"fieldValue":"책 리뷰","totalCount":6},{"fieldValue":"프롬프트","totalCount":1}]},"markdownRemark":{"id":"a9dbd7bf-89ee-54b4-93b0-3468719ee49c","html":"<h1>대용량 DB 솔루션 - 데이터 저장구조와 특징</h1>\n<h2>1.1 테이블과 인덱스의 분리형</h2>\n<p>테이블 - 데이터를 저장\n인덱스 - 특정 데이터를 찾기 위한 경로로 사용되는 테이블과는 다른 별개의 객체</p>\n<p>관계형 데이터베이스 이전에는 키와 데이터가 밀접한 관련이 있었다. 저장된 데이터에서 특정한 범위를 선별해서 조회 시, 키의 도움이 필수적 -> 데이터의 저장은 키에 의존적이었다.</p>\n<h3>분리형 테이블의 구조</h3>\n<p>데이터가 저장된 블록 상태</p>\n<ul>\n<li>한번도 사용되지 않았던 블록</li>\n<li>일정량 이상의 빈 공간이 확보된 재사용 허용 블록</li>\n<li>잔여 공간이 일정 이하라 재사용 미허용 블록</li>\n</ul>\n<p>활용 가능한 블록은 사용 목록(Free List)에 기록되었다가 데이터를 저장할 때, 사용할 블록으로 제공된다.\n한 개의 Row가 한 조각 안에 모두 위치되도록 하기 위해, Row의 데이터가 끊어지지 않고 들어갈 수 있는 공간이 없다면 전체 블록의 Row 위치를 재배치한다.</p>\n<p>블록 하단의 FREE SPACE는 이미 포함되어있는 Row들의 길이 변화시 사용하는 공간으로 테이블 정의 시에 파라미터로 지정할 수 있다.</p>\n<h3>\b인덱스 - ROWID</h3>\n<p>인덱스의 ROWID - 오브젝트 번호 + 데이터 파일 번호(테이블마다의 일련 번호 + 블록 번호 + 슬롯 번호로 구성, 데이터 파일의 절대번호는 미포함</p>\n<h4>하나의 블록을 벗어나지 않는 경우</h4>\n<p>블록 내에서 Row의 위치가 변경되더라도 ROWID는 변경되지 않음</p>\n<p>집계한 여유 공간이 있더라도 이어진 조각이 없어 저장이 불가능해지면, 자동으로 블록의 Row를 재구성하는 응축 작업이 진행된다. if 여유 공간을 적게 지정 시, 빈번한 응축 작업이 발생하여 부하의 원인이 될 수도 있다.\nRow 길이가 증가할 확률이 높지 않더라도 수정이 빈번하게 발생할 가능성이 높다면 충분하게 여유 공간(PCTFREE)을 지정해주는 것 또한 하나의 처리 효율성을 위한 전략이다.</p>\n<h4>추가적인 블록을 사용하는 경우</h4>\n<p>여유 공간을 충분하게 부여하더라도 기존 Row들의 길이가 너무 길어져서 응축을 하더라도 사용할 여유공간이 부족하게되면 다른 블록으로 부족한 공간을 메울 수 밖에 없다. Row가 다른 블록으로 이동은 ROWID의 변경을 의미한다. ROWID를 변경시키지 않는 방법에는 과거의 ROWID로 조회 시 변경된 ROWID를 넣어두는 방식이 있다. 해당 방식의 경우, 인덱스의 ROWID를 변경시키지 않는 대신 데이터 엑세스시 여러 블록을 읽어야하는 오버헤드가 존재한다.</p>\n<h3>Row Migration</h3>\n<p>Row가 기존 블록에서 추가적인 외부의 블록으로 데이터를 옮기는 상태를 Row의 이주(Migration)이라 부른다. 해당 상태는 Row나 테이블을 삭제하고 재생성시 제거 가능하다.</p>\n<h3>Chain</h3>\n<p>여러 블록에 걸쳐 데이터가 존재한다는 점은 Migration과 유사하다.\n특정 Row의 길이가 한 블록을 넘는다면 어떤 방법을 사용하더라도 하나의 블록 내에는 존재할 수가 없는데 해당 상황에서 필요한 공간만큼 블록을 연결해서 저장하는 것을 '체인이 발생했다.' 라고 말한다.</p>\n<h3>블록 내부의 Row</h3>\n<p>블록내에 존재하는 Row는 가변길이로 존재한다. NULL값이 존재한다면 나중에 값이 들어올 때, Row의 길이는 영향을 받고, 분할 저장되지 않기 위해 위치 이동이 발생할 수도 있다. Row의 이동에 의해 인덱스가 영향을 받지않으려면, 과거의 ROWID에 변경된 ROWID를 넣어두는 방식으로 인덱스가 관리되어야한다.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n</style>","fields":{"slug":"/posts/book/대용량-DB-솔루션/1장/"},"timeToRead":1,"frontmatter":{"title":"대용량 DB 솔루션 1장 정리","tags":["책 스터디"],"date":"2023-09-28T15:23:12.000Z","image":null,"series":"대용량 DB 솔루션"}}},"pageContext":{"id":"a9dbd7bf-89ee-54b4-93b0-3468719ee49c"}},"staticQueryHashes":["3810308631","4253518612"],"slicesMap":{}}